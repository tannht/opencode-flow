{"version":3,"sources":["../../../../src/cli/simple-commands/hooks.js"],"sourcesContent":["import {\n  printSuccess,\n  printError,\n  printWarning,\n  execRuvSwarmHook,\n  checkRuvSwarmAvailable,\n} from '../utils.js';\nimport { SqliteMemoryStore } from '../../memory/sqlite-store.js';\nimport { InMemoryStore } from '../../memory/in-memory-store.js';\n\n// Initialize memory store\nlet memoryStore = null;\nlet storeInitFailed = false;\n\nasync function getMemoryStore() {\n  if (memoryStore) return memoryStore;\n\n  // If we already failed, return a working in-memory store\n  if (storeInitFailed) {\n    if (!memoryStore) {\n      memoryStore = new InMemoryStore();\n      await memoryStore.initialize();\n    }\n    return memoryStore;\n  }\n\n  try {\n    memoryStore = new SqliteMemoryStore();\n    await memoryStore.initialize();\n  } catch (err) {\n    // Check if it's a native module error (NODE_MODULE_VERSION mismatch)\n    const isNativeModuleError =\n      err.message?.includes('NODE_MODULE_VERSION') ||\n      err.message?.includes('was compiled against a different Node.js version') ||\n      err.message?.includes('better-sqlite3') ||\n      err.message?.includes('SQLite is not available');\n\n    if (isNativeModuleError) {\n      printWarning(`SQLite unavailable, using in-memory storage for hooks (data won't persist)`);\n      storeInitFailed = true;\n      memoryStore = new InMemoryStore();\n      await memoryStore.initialize();\n    } else {\n      throw err;\n    }\n  }\n\n  return memoryStore;\n}\n\n// Simple ID generator\nfunction generateId(prefix = 'id') {\n  return `${prefix}-${Date.now()}-${Math.random().toString(36).substr(2, 9)}`;\n}\n\nexport async function hooksAction(subArgs, flags) {\n  const subcommand = subArgs[0];\n  const options = flags;\n\n  if (options.help || options.h || !subcommand) {\n    showHooksHelp();\n    return;\n  }\n\n  try {\n    switch (subcommand) {\n      // Pre-Operation Hooks\n      case 'pre-task':\n        await preTaskCommand(subArgs, flags);\n        break;\n      case 'pre-edit':\n        await preEditCommand(subArgs, flags);\n        break;\n      case 'pre-bash':\n      case 'pre-command': // Support both names for compatibility\n        await preBashCommand(subArgs, flags);\n        break;\n\n      // Post-Operation Hooks\n      case 'post-task':\n        await postTaskCommand(subArgs, flags);\n        break;\n      case 'post-edit':\n        await postEditCommand(subArgs, flags);\n        break;\n      case 'post-bash':\n      case 'post-command': // Support both names for compatibility\n        await postBashCommand(subArgs, flags);\n        break;\n      case 'post-search':\n        await postSearchCommand(subArgs, flags);\n        break;\n\n      // MCP Integration Hooks\n      case 'mcp-initialized':\n        await mcpInitializedCommand(subArgs, flags);\n        break;\n      case 'agent-spawned':\n        await agentSpawnedCommand(subArgs, flags);\n        break;\n      case 'task-orchestrated':\n        await taskOrchestratedCommand(subArgs, flags);\n        break;\n      case 'neural-trained':\n        await neuralTrainedCommand(subArgs, flags);\n        break;\n\n      // Session Hooks\n      case 'session-end':\n        await sessionEndCommand(subArgs, flags);\n        break;\n      case 'session-restore':\n        await sessionRestoreCommand(subArgs, flags);\n        break;\n      case 'notify':\n        await notifyCommand(subArgs, flags);\n        break;\n\n      // NEW: PreToolUse Modification Hooks (v2.0.10+)\n      case 'modify-bash':\n        await modifyBashCommand(subArgs, flags);\n        break;\n      case 'modify-file':\n        await modifyFileCommand(subArgs, flags);\n        break;\n      case 'modify-git-commit':\n        await modifyGitCommitCommand(subArgs, flags);\n        break;\n\n      default:\n        printError(`Unknown hooks command: ${subcommand}`);\n        showHooksHelp();\n    }\n  } catch (err) {\n    printError(`Hooks command failed: ${err.message}`);\n  }\n}\n\n// ===== PRE-OPERATION HOOKS =====\n\nasync function preTaskCommand(subArgs, flags) {\n  const options = flags;\n  const description = options.description || 'Unnamed task';\n  const taskId = options['task-id'] || options.taskId || generateId('task');\n  const agentId = options['agent-id'] || options.agentId;\n  const autoSpawnAgents = options['auto-spawn-agents'] !== 'false';\n\n  console.log(`ðŸ”„ Executing pre-task hook...`);\n  console.log(`ðŸ“‹ Task: ${description}`);\n  console.log(`ðŸ†” Task ID: ${taskId}`);\n  if (agentId) console.log(`ðŸ¤– Agent: ${agentId}`);\n\n  try {\n    const store = await getMemoryStore();\n    const taskData = {\n      taskId,\n      description,\n      agentId,\n      autoSpawnAgents,\n      status: 'started',\n      startedAt: new Date().toISOString(),\n    };\n\n    await store.store(`task:${taskId}`, taskData, {\n      namespace: 'hooks:pre-task',\n      metadata: { hookType: 'pre-task', agentId },\n    });\n\n    await store.store(\n      `task-index:${Date.now()}`,\n      {\n        taskId,\n        description,\n        timestamp: new Date().toISOString(),\n      },\n      { namespace: 'task-index' },\n    );\n\n    console.log(`  ðŸ’¾ Saved to .swarm/memory.db`);\n\n    // Execute ruv-swarm hook if available (with timeout for npx scenarios)\n    try {\n      const checkPromise = checkRuvSwarmAvailable();\n      const timeoutPromise = new Promise((_, reject) => \n        setTimeout(() => reject(new Error('Timeout')), 3000)\n      );\n      \n      const isAvailable = await Promise.race([checkPromise, timeoutPromise]);\n      \n      if (isAvailable) {\n        console.log(`\\nðŸ”„ Executing ruv-swarm pre-task hook...`);\n        const hookResult = await execRuvSwarmHook('pre-task', {\n          description,\n          'task-id': taskId,\n          'auto-spawn-agents': autoSpawnAgents,\n          ...(agentId ? { 'agent-id': agentId } : {}),\n        });\n\n        if (hookResult.success) {\n          await store.store(\n            `task:${taskId}:ruv-output`,\n            {\n              output: hookResult.output,\n              timestamp: new Date().toISOString(),\n            },\n            { namespace: 'hooks:ruv-swarm' },\n          );\n\n          printSuccess(`Pre-task hook completed successfully`);\n        }\n      }\n    } catch (err) {\n      // Skip ruv-swarm hook if it times out or fails\n      console.log(`\\nâš ï¸  Skipping ruv-swarm hook (${err.message})`);\n    }\n\n    console.log(`\\nðŸŽ¯ TASK PREPARATION COMPLETE`);\n    \n    // Close the memory store to prevent hanging\n    if (memoryStore && memoryStore.close) {\n      memoryStore.close();\n    }\n    \n    // Force exit after a short delay to ensure cleanup\n    setTimeout(() => {\n      process.exit(0);\n    }, 100);\n  } catch (err) {\n    printError(`Pre-task hook failed: ${err.message}`);\n    \n    // Close the memory store on error too\n    if (memoryStore && memoryStore.close) {\n      memoryStore.close();\n    }\n    \n    // Force exit after a short delay to ensure cleanup\n    setTimeout(() => {\n      process.exit(1);\n    }, 100);\n  }\n}\n\nasync function preEditCommand(subArgs, flags) {\n  const options = flags;\n  const file = options.file || 'unknown-file';\n  const operation = options.operation || 'edit';\n  const autoAssignAgents = options['auto-assign-agents'] || false;\n  const loadContext = options['load-context'] || false;\n\n  console.log(`ðŸ“ Executing pre-edit hook...`);\n  console.log(`ðŸ“„ File: ${file}`);\n  console.log(`âš™ï¸  Operation: ${operation}`);\n  if (autoAssignAgents) console.log(`ðŸ¤– Auto-assign agents: ENABLED`);\n  if (loadContext) console.log(`ðŸ”„ Load context: ENABLED`);\n\n  try {\n    const store = await getMemoryStore();\n\n    // Auto-assign agents based on file type\n    let assignedAgentType = 'general';\n    let recommendedAgent = null;\n\n    if (autoAssignAgents) {\n      const path = await import('path');\n      const ext = path.extname(file).toLowerCase();\n\n      const agentMapping = {\n        '.js': 'javascript-developer',\n        '.ts': 'typescript-developer',\n        '.py': 'python-developer',\n        '.go': 'golang-developer',\n        '.rs': 'rust-developer',\n        '.java': 'java-developer',\n        '.cpp': 'cpp-developer',\n        '.c': 'c-developer',\n        '.css': 'frontend-developer',\n        '.html': 'frontend-developer',\n        '.vue': 'frontend-developer',\n        '.react': 'frontend-developer',\n        '.md': 'technical-writer',\n        '.yml': 'devops-engineer',\n        '.yaml': 'devops-engineer',\n        '.json': 'config-specialist',\n        '.sql': 'database-expert',\n        '.sh': 'system-admin',\n        '.dockerfile': 'devops-engineer',\n      };\n\n      assignedAgentType = agentMapping[ext] || 'general-developer';\n      recommendedAgent = {\n        type: assignedAgentType,\n        file: file,\n        extension: ext,\n        recommended: true,\n      };\n\n      console.log(`  ðŸ¤– Recommended agent: ${assignedAgentType}`);\n    }\n\n    // Load context if requested\n    let contextData = null;\n    if (loadContext) {\n      try {\n        // Check if file exists and get basic info\n        const fs = await import('fs');\n        const path = await import('path');\n\n        if (fs.existsSync(file)) {\n          const stats = fs.statSync(file);\n          const dirname = path.dirname(file);\n          const basename = path.basename(file);\n\n          contextData = {\n            fileExists: true,\n            size: stats.size,\n            modified: stats.mtime,\n            directory: dirname,\n            filename: basename,\n            isDirectory: stats.isDirectory(),\n          };\n\n          console.log(`  ðŸ“ Context loaded: ${basename} (${stats.size} bytes)`);\n        } else {\n          contextData = {\n            fileExists: false,\n            willCreate: true,\n            directory: path.dirname(file),\n            filename: path.basename(file),\n          };\n          console.log(`  ðŸ“ Context: New file will be created`);\n        }\n      } catch (err) {\n        console.log(`  âš ï¸  Warning: Could not load context for ${file}`);\n        contextData = { error: err.message };\n      }\n    }\n\n    const editData = {\n      file,\n      operation,\n      timestamp: new Date().toISOString(),\n      editId: generateId('edit'),\n      autoAssignAgents,\n      loadContext,\n      assignedAgentType,\n      recommendedAgent,\n      contextData,\n    };\n\n    await store.store(`edit:${editData.editId}:pre`, editData, {\n      namespace: 'hooks:pre-edit',\n      metadata: { hookType: 'pre-edit', file, agentType: assignedAgentType },\n    });\n\n    // Store agent recommendation if enabled\n    if (autoAssignAgents && recommendedAgent) {\n      await store.store(`agent-recommendation:${file}`, recommendedAgent, {\n        namespace: 'agent-assignments',\n        ttl: 3600, // 1 hour\n      });\n    }\n\n    console.log(`  ðŸ’¾ Pre-edit state saved to .swarm/memory.db`);\n    printSuccess(`Pre-edit hook completed`);\n  } catch (err) {\n    printError(`Pre-edit hook failed: ${err.message}`);\n  }\n}\n\nasync function preBashCommand(subArgs, flags) {\n  const options = flags;\n  const command = options.command || subArgs.slice(1).join(' ') || '';\n  const workingDir = options.cwd || process.cwd();\n  const validateSafety = options['validate-safety'] === true || options['validate-safety'] === 'true' || options.validate === true || options.validate === 'true' || false;\n  const prepareResources = options['prepare-resources'] === true || options['prepare-resources'] === 'true' || false;\n\n  console.log(`ðŸ”§ Executing pre-bash hook...`);\n  console.log(`ðŸ“œ Command: ${command}`);\n  console.log(`ðŸ“ Working dir: ${workingDir}`);\n  if (validateSafety) console.log(`ðŸ”’ Safety validation: ENABLED`);\n  if (prepareResources) console.log(`ðŸ› ï¸  Resource preparation: ENABLED`);\n\n  try {\n    const store = await getMemoryStore();\n    let safetyResult = 'skipped';\n\n    if (validateSafety) {\n      // Basic safety validation\n      const dangerousCommands = [\n        'rm -rf /',\n        'rm -rf .',\n        'rm -rf *',\n        'format',\n        'fdisk',\n        'mkfs',\n        'curl * | bash',\n        'wget * | sh',\n        'eval',\n        'exec',\n        'chmod 777',\n      ];\n\n      const isDangerous = command && typeof command === 'string' && command.length > 0 \n        ? dangerousCommands.some((dangerous) =>\n            command.toLowerCase().includes(dangerous.toLowerCase()),\n          )\n        : false;\n\n      safetyResult = isDangerous ? 'dangerous' : 'safe';\n\n      if (isDangerous) {\n        console.log(`  âš ï¸  Safety check: DANGEROUS COMMAND DETECTED`);\n        console.log(`  ðŸš« Command blocked for safety`);\n        printError(`Command blocked due to safety validation: ${command}`);\n        return;\n      }\n    }\n\n    if (prepareResources) {\n      // Resource preparation - create working directory if needed\n      const fs = await import('fs');\n      const path = await import('path');\n\n      if (!fs.existsSync(workingDir)) {\n        fs.mkdirSync(workingDir, { recursive: true });\n        console.log(`  ðŸ“ Created working directory: ${workingDir}`);\n      }\n\n      // Check available disk space\n      try {\n        const stats = fs.statSync(workingDir);\n        console.log(`  ðŸ’¾ Working directory prepared`);\n      } catch (err) {\n        console.log(`  âš ï¸  Warning: Could not check working directory`);\n      }\n    }\n\n    const bashData = {\n      command,\n      workingDir,\n      timestamp: new Date().toISOString(),\n      bashId: generateId('bash'),\n      safety: safetyResult,\n      validationEnabled: validateSafety,\n      resourcesPrepped: prepareResources,\n    };\n\n    await store.store(`bash:${bashData.bashId}:pre`, bashData, {\n      namespace: 'hooks:pre-bash',\n      metadata: { hookType: 'pre-bash', command, safety: safetyResult },\n    });\n\n    console.log(`  ðŸ’¾ Command logged to .swarm/memory.db`);\n    console.log(`  ðŸ”’ Safety check: ${safetyResult.toUpperCase()}`);\n    printSuccess(`Pre-bash hook completed`);\n  } catch (err) {\n    printError(`Pre-bash hook failed: ${err.message}`);\n  }\n}\n\n// ===== POST-OPERATION HOOKS =====\n\nasync function postTaskCommand(subArgs, flags) {\n  const options = flags;\n  const taskId = options['task-id'] || options.taskId || generateId('task');\n  const analyzePerformance = options['analyze-performance'] !== 'false';\n\n  console.log(`ðŸ Executing post-task hook...`);\n  console.log(`ðŸ†” Task ID: ${taskId}`);\n\n  try {\n    const store = await getMemoryStore();\n    const taskData = await store.retrieve(`task:${taskId}`, {\n      namespace: 'hooks:pre-task',\n    });\n\n    const completedData = {\n      ...(taskData || {}),\n      status: 'completed',\n      completedAt: new Date().toISOString(),\n      duration: taskData ? Date.now() - new Date(taskData.startedAt).getTime() : null,\n    };\n\n    await store.store(`task:${taskId}:completed`, completedData, {\n      namespace: 'hooks:post-task',\n      metadata: { hookType: 'post-task' },\n    });\n\n    if (analyzePerformance && completedData.duration) {\n      const metrics = {\n        taskId,\n        duration: completedData.duration,\n        durationHuman: `${(completedData.duration / 1000).toFixed(2)}s`,\n        timestamp: new Date().toISOString(),\n      };\n\n      await store.store(`metrics:${taskId}`, metrics, {\n        namespace: 'performance',\n      });\n      console.log(`  ðŸ“Š Performance: ${metrics.durationHuman}`);\n    }\n\n    console.log(`  ðŸ’¾ Task completion saved to .swarm/memory.db`);\n    printSuccess(`Post-task hook completed`);\n  } catch (err) {\n    printError(`Post-task hook failed: ${err.message}`);\n  }\n}\n\nasync function postEditCommand(subArgs, flags) {\n  const options = flags;\n  const file = options.file || 'unknown-file';\n  let memoryKey = options['memory-key'] || options.memoryKey;\n  \n  // Handle case where memory-key is passed as a boolean flag without value\n  if (memoryKey === true) {\n    // Generate a default memory key based on the file path and timestamp\n    const path = await import('path');\n    const basename = path.basename(file);\n    memoryKey = `edit:${basename}:${Date.now()}`;\n  }\n  \n  const format = options.format || false;\n  const updateMemory = options['update-memory'] || false;\n  const trainNeural = options['train-neural'] || false;\n\n  console.log(`ðŸ“ Executing post-edit hook...`);\n  console.log(`ðŸ“„ File: ${file}`);\n  if (memoryKey) console.log(`ðŸ’¾ Memory key: ${memoryKey}`);\n  if (format) console.log(`ðŸŽ¨ Auto-format: ENABLED`);\n  if (updateMemory) console.log(`ðŸ§  Memory update: ENABLED`);\n  if (trainNeural) console.log(`ðŸ¤– Neural training: ENABLED`);\n\n  try {\n    const store = await getMemoryStore();\n    const path = await import('path');\n    const fs = await import('fs');\n\n    // Auto-format file if requested\n    let formatResult = null;\n    if (format && fs.existsSync(file)) {\n      const ext = path.extname(file).toLowerCase();\n      const formatters = {\n        '.js': 'prettier',\n        '.ts': 'prettier',\n        '.json': 'prettier',\n        '.css': 'prettier',\n        '.html': 'prettier',\n        '.py': 'black',\n        '.go': 'gofmt',\n        '.rs': 'rustfmt',\n        '.java': 'google-java-format',\n        '.cpp': 'clang-format',\n        '.c': 'clang-format',\n      };\n\n      const formatter = formatters[ext];\n      if (formatter) {\n        console.log(`  ðŸŽ¨ Auto-formatting with ${formatter}...`);\n        formatResult = {\n          formatter,\n          extension: ext,\n          attempted: true,\n          timestamp: new Date().toISOString(),\n        };\n      } else {\n        console.log(`  âš ï¸  No formatter available for ${ext}`);\n        formatResult = {\n          extension: ext,\n          attempted: false,\n          reason: 'No formatter available',\n        };\n      }\n    }\n\n    // Update memory with edit context\n    let memoryUpdate = null;\n    if (updateMemory) {\n      const editContext = {\n        file,\n        editedAt: new Date().toISOString(),\n        editId: generateId('edit'),\n        formatted: formatResult?.attempted || false,\n        fileSize: fs.existsSync(file) ? fs.statSync(file).size : 0,\n        directory: path.dirname(file),\n        basename: path.basename(file),\n      };\n\n      memoryUpdate = editContext;\n\n      // Store in coordination namespace\n      await store.store(`edit-context:${editContext.editId}`, editContext, {\n        namespace: 'coordination',\n        metadata: { type: 'edit-context', file },\n      });\n\n      console.log(`  ðŸ§  Edit context stored in memory`);\n    }\n\n    // Train neural patterns if requested\n    let neuralTraining = null;\n    if (trainNeural) {\n      // Simulate neural training with file patterns\n      const ext = path.extname(file).toLowerCase();\n      const basename = path.basename(file);\n      const editTime = new Date().toISOString();\n\n      const patterns = {\n        fileType: ext,\n        fileName: basename,\n        editTime,\n        confidence: Math.random() * 0.5 + 0.5, // 50-100% confidence\n        patterns: [\n          `${ext}_edit_pattern`,\n          `${basename}_modification`,\n          `edit_${Date.now()}_sequence`,\n        ],\n      };\n\n      neuralTraining = patterns;\n\n      await store.store(`neural-pattern:${generateId('pattern')}`, patterns, {\n        namespace: 'neural-training',\n        metadata: { type: 'edit-pattern', file, extension: ext },\n      });\n\n      console.log(\n        `  ðŸ¤– Neural patterns trained (${(patterns.confidence * 100).toFixed(1)}% confidence)`,\n      );\n    }\n\n    const editData = {\n      file,\n      memoryKey,\n      timestamp: new Date().toISOString(),\n      editId: generateId('edit'),\n      format,\n      updateMemory,\n      trainNeural,\n      formatResult,\n      memoryUpdate,\n      neuralTraining,\n    };\n\n    await store.store(`edit:${editData.editId}:post`, editData, {\n      namespace: 'hooks:post-edit',\n      metadata: { hookType: 'post-edit', file, formatted: formatResult?.attempted || false },\n    });\n\n    if (memoryKey && typeof memoryKey === 'string') {\n      await store.store(\n        memoryKey,\n        {\n          file,\n          editedAt: new Date().toISOString(),\n          editId: editData.editId,\n          enhanced: true,\n          formatResult,\n          memoryUpdate,\n          neuralTraining,\n        },\n        { namespace: 'coordination' },\n      );\n    }\n\n    const historyKey = `file-history:${file.replace(/\\//g, '_')}:${Date.now()}`;\n    await store.store(\n      historyKey,\n      {\n        file,\n        editId: editData.editId,\n        timestamp: new Date().toISOString(),\n        enhanced: true,\n        features: {\n          format,\n          updateMemory,\n          trainNeural,\n        },\n      },\n      { namespace: 'file-history' },\n    );\n\n    console.log(`  ðŸ’¾ Post-edit data saved to .swarm/memory.db`);\n    printSuccess(`Post-edit hook completed`);\n  } catch (err) {\n    printError(`Post-edit hook failed: ${err.message}`);\n  }\n}\n\nasync function postBashCommand(subArgs, flags) {\n  const options = flags;\n  const command = options.command || subArgs.slice(1).join(' ');\n  const exitCode = options['exit-code'] || '0';\n  const output = options.output || '';\n  const trackMetrics = options['track-metrics'] || false;\n  const storeResults = options['store-results'] || false;\n  const duration = options.duration || 0;\n\n  console.log(`ðŸ”§ Executing post-bash hook...`);\n  console.log(`ðŸ“œ Command: ${command}`);\n  console.log(`ðŸ“Š Exit code: ${exitCode}`);\n  if (trackMetrics) console.log(`ðŸ“Š Metrics tracking: ENABLED`);\n  if (storeResults) console.log(`ðŸ’¾ Results storage: ENABLED`);\n\n  try {\n    const store = await getMemoryStore();\n    const startTime = Date.now();\n\n    // Calculate performance metrics if enabled\n    let metrics = null;\n    if (trackMetrics) {\n      const commandLength = command.length;\n      const outputLength = output.length;\n      const success = parseInt(exitCode) === 0;\n\n      metrics = {\n        commandLength,\n        outputLength,\n        success,\n        duration: parseInt(duration) || 0,\n        exitCode: parseInt(exitCode),\n        timestamp: new Date().toISOString(),\n        complexity: commandLength > 100 ? 'high' : commandLength > 50 ? 'medium' : 'low',\n      };\n\n      console.log(\n        `  ðŸ“Š Command metrics: ${commandLength} chars, ${outputLength} output, ${success ? 'SUCCESS' : 'FAILED'}`,\n      );\n    }\n\n    const bashData = {\n      command,\n      exitCode,\n      output: storeResults ? output.substring(0, 5000) : output.substring(0, 1000), // Store more if requested\n      timestamp: new Date().toISOString(),\n      bashId: generateId('bash'),\n      trackMetrics,\n      storeResults,\n      metrics,\n    };\n\n    await store.store(`bash:${bashData.bashId}:post`, bashData, {\n      namespace: 'hooks:post-bash',\n      metadata: { hookType: 'post-bash', command, exitCode, success: parseInt(exitCode) === 0 },\n    });\n\n    // Store detailed results if enabled\n    if (storeResults) {\n      await store.store(\n        `command-results:${bashData.bashId}`,\n        {\n          command,\n          exitCode,\n          output,\n          timestamp: new Date().toISOString(),\n          fullOutput: true,\n        },\n        { namespace: 'command-results' },\n      );\n\n      console.log(`  ðŸ’¾ Full command results stored`);\n    }\n\n    // Store metrics if enabled\n    if (trackMetrics && metrics) {\n      await store.store(`command-metrics:${bashData.bashId}`, metrics, {\n        namespace: 'performance-metrics',\n      });\n\n      // Update running metrics\n      const existingMetrics = (await store.retrieve('command-metrics-summary', {\n        namespace: 'performance-metrics',\n      })) || { totalCommands: 0, successRate: 0, avgDuration: 0 };\n\n      existingMetrics.totalCommands += 1;\n      existingMetrics.successRate =\n        (existingMetrics.successRate * (existingMetrics.totalCommands - 1) +\n          (metrics.success ? 1 : 0)) /\n        existingMetrics.totalCommands;\n      existingMetrics.avgDuration =\n        (existingMetrics.avgDuration * (existingMetrics.totalCommands - 1) + metrics.duration) /\n        existingMetrics.totalCommands;\n      existingMetrics.lastUpdated = new Date().toISOString();\n\n      await store.store('command-metrics-summary', existingMetrics, {\n        namespace: 'performance-metrics',\n      });\n    }\n\n    // Update command history\n    await store.store(\n      `command-history:${Date.now()}`,\n      {\n        command,\n        exitCode,\n        timestamp: new Date().toISOString(),\n        success: parseInt(exitCode) === 0,\n        hasMetrics: trackMetrics,\n        hasResults: storeResults,\n      },\n      { namespace: 'command-history' },\n    );\n\n    console.log(`  ðŸ’¾ Command execution logged to .swarm/memory.db`);\n    printSuccess(`Post-bash hook completed`);\n  } catch (err) {\n    printError(`Post-bash hook failed: ${err.message}`);\n  }\n}\n\nasync function postSearchCommand(subArgs, flags) {\n  const options = flags;\n  const query = options.query || subArgs.slice(1).join(' ');\n  const resultCount = options['result-count'] || '0';\n  const searchType = options.type || 'general';\n\n  console.log(`ðŸ” Executing post-search hook...`);\n  console.log(`ðŸ”Ž Query: ${query}`);\n  console.log(`ðŸ“Š Results: ${resultCount}`);\n\n  try {\n    const store = await getMemoryStore();\n    const searchData = {\n      query,\n      resultCount: parseInt(resultCount),\n      searchType,\n      timestamp: new Date().toISOString(),\n      searchId: generateId('search'),\n    };\n\n    await store.store(`search:${searchData.searchId}`, searchData, {\n      namespace: 'hooks:post-search',\n      metadata: { hookType: 'post-search', query },\n    });\n\n    // Cache search for future use\n    await store.store(\n      `search-cache:${query}`,\n      {\n        resultCount: searchData.resultCount,\n        cachedAt: new Date().toISOString(),\n      },\n      { namespace: 'search-cache', ttl: 3600 },\n    ); // 1 hour TTL\n\n    console.log(`  ðŸ’¾ Search results cached to .swarm/memory.db`);\n    printSuccess(`Post-search hook completed`);\n  } catch (err) {\n    printError(`Post-search hook failed: ${err.message}`);\n  }\n}\n\n// ===== MCP INTEGRATION HOOKS =====\n\nasync function mcpInitializedCommand(subArgs, flags) {\n  const options = flags;\n  const serverName = options.server || 'claude-flow';\n  const sessionId = options['session-id'] || generateId('mcp-session');\n\n  console.log(`ðŸ”Œ Executing mcp-initialized hook...`);\n  console.log(`ðŸ’» Server: ${serverName}`);\n  console.log(`ðŸ†” Session: ${sessionId}`);\n\n  try {\n    const store = await getMemoryStore();\n    const mcpData = {\n      serverName,\n      sessionId,\n      initializedAt: new Date().toISOString(),\n      status: 'active',\n    };\n\n    await store.store(`mcp:${sessionId}`, mcpData, {\n      namespace: 'hooks:mcp-initialized',\n      metadata: { hookType: 'mcp-initialized', server: serverName },\n    });\n\n    console.log(`  ðŸ’¾ MCP session saved to .swarm/memory.db`);\n    printSuccess(`MCP initialized hook completed`);\n  } catch (err) {\n    printError(`MCP initialized hook failed: ${err.message}`);\n  }\n}\n\nasync function agentSpawnedCommand(subArgs, flags) {\n  const options = flags;\n  const agentType = options.type || 'generic';\n  const agentName = options.name || generateId('agent');\n  const swarmId = options['swarm-id'] || 'default';\n\n  console.log(`ðŸ¤– Executing agent-spawned hook...`);\n  console.log(`ðŸ“› Agent: ${agentName}`);\n  console.log(`ðŸ·ï¸  Type: ${agentType}`);\n\n  try {\n    const store = await getMemoryStore();\n    const agentData = {\n      agentName,\n      agentType,\n      swarmId,\n      spawnedAt: new Date().toISOString(),\n      status: 'active',\n    };\n\n    await store.store(`agent:${agentName}`, agentData, {\n      namespace: 'hooks:agent-spawned',\n      metadata: { hookType: 'agent-spawned', type: agentType },\n    });\n\n    // Update agent roster\n    await store.store(\n      `agent-roster:${Date.now()}`,\n      {\n        agentName,\n        action: 'spawned',\n        timestamp: new Date().toISOString(),\n      },\n      { namespace: 'agent-roster' },\n    );\n\n    console.log(`  ðŸ’¾ Agent registered to .swarm/memory.db`);\n    printSuccess(`Agent spawned hook completed`);\n  } catch (err) {\n    printError(`Agent spawned hook failed: ${err.message}`);\n  }\n}\n\nasync function taskOrchestratedCommand(subArgs, flags) {\n  const options = flags;\n  const taskId = options['task-id'] || generateId('orchestrated-task');\n  const strategy = options.strategy || 'balanced';\n  const priority = options.priority || 'medium';\n\n  console.log(`ðŸŽ­ Executing task-orchestrated hook...`);\n  console.log(`ðŸ†” Task: ${taskId}`);\n  console.log(`ðŸ“Š Strategy: ${strategy}`);\n\n  try {\n    const store = await getMemoryStore();\n    const orchestrationData = {\n      taskId,\n      strategy,\n      priority,\n      orchestratedAt: new Date().toISOString(),\n      status: 'orchestrated',\n    };\n\n    await store.store(`orchestration:${taskId}`, orchestrationData, {\n      namespace: 'hooks:task-orchestrated',\n      metadata: { hookType: 'task-orchestrated', strategy },\n    });\n\n    console.log(`  ðŸ’¾ Orchestration saved to .swarm/memory.db`);\n    printSuccess(`Task orchestrated hook completed`);\n  } catch (err) {\n    printError(`Task orchestrated hook failed: ${err.message}`);\n  }\n}\n\nasync function neuralTrainedCommand(subArgs, flags) {\n  const options = flags;\n  const modelName = options.model || 'default-neural';\n  const accuracy = options.accuracy || '0.0';\n  const patterns = options.patterns || '0';\n\n  console.log(`ðŸ§  Executing neural-trained hook...`);\n  console.log(`ðŸ¤– Model: ${modelName}`);\n  console.log(`ðŸ“Š Accuracy: ${accuracy}%`);\n\n  try {\n    const store = await getMemoryStore();\n    const trainingData = {\n      modelName,\n      accuracy: parseFloat(accuracy),\n      patternsLearned: parseInt(patterns),\n      trainedAt: new Date().toISOString(),\n    };\n\n    await store.store(`neural:${modelName}:${Date.now()}`, trainingData, {\n      namespace: 'hooks:neural-trained',\n      metadata: { hookType: 'neural-trained', model: modelName },\n    });\n\n    console.log(`  ðŸ’¾ Training results saved to .swarm/memory.db`);\n    printSuccess(`Neural trained hook completed`);\n  } catch (err) {\n    printError(`Neural trained hook failed: ${err.message}`);\n  }\n}\n\n// ===== SESSION HOOKS =====\n\nasync function sessionEndCommand(subArgs, flags) {\n  const options = flags;\n  const generateSummary = options['generate-summary'] !== 'false';\n  const persistState = options['persist-state'] !== 'false';\n  const exportMetrics = options['export-metrics'] || false;\n\n  console.log(`ðŸ”š Executing session-end hook...`);\n  if (generateSummary) console.log(`ðŸ“Š Summary generation: ENABLED`);\n  if (persistState) console.log(`ðŸ’¾ State persistence: ENABLED`);\n  if (exportMetrics) console.log(`ðŸ“ˆ Metrics export: ENABLED`);\n\n  try {\n    const store = await getMemoryStore();\n    const tasks = await store.list({ namespace: 'task-index', limit: 1000 });\n    const edits = await store.list({ namespace: 'file-history', limit: 1000 });\n    const commands = await store.list({ namespace: 'command-history', limit: 1000 });\n    const agents = await store.list({ namespace: 'agent-roster', limit: 1000 });\n\n    // Calculate session metrics\n    let metrics = null;\n    if (exportMetrics) {\n      const now = new Date();\n      const sessionStart = Math.min(\n        ...tasks.map((t) => new Date(t.value.timestamp || now).getTime()),\n        ...edits.map((e) => new Date(e.value.timestamp || now).getTime()),\n        ...commands.map((c) => new Date(c.value.timestamp || now).getTime()),\n      );\n\n      const duration = now.getTime() - sessionStart;\n      const successfulCommands = commands.filter((c) => c.value.success !== false).length;\n      const commandSuccessRate = commands.length > 0 ? successfulCommands / commands.length : 1;\n\n      metrics = {\n        sessionDuration: duration,\n        sessionDurationHuman: `${Math.round(duration / 1000 / 60)} minutes`,\n        totalTasks: tasks.length,\n        totalEdits: edits.length,\n        totalCommands: commands.length,\n        uniqueAgents: agents.length,\n        commandSuccessRate: Math.round(commandSuccessRate * 100),\n        avgTasksPerMinute: Math.round((tasks.length / (duration / 1000 / 60)) * 100) / 100,\n        avgEditsPerMinute: Math.round((edits.length / (duration / 1000 / 60)) * 100) / 100,\n        timestamp: now.toISOString(),\n      };\n    }\n\n    const sessionData = {\n      endedAt: new Date().toISOString(),\n      totalTasks: tasks.length,\n      totalEdits: edits.length,\n      totalCommands: commands.length,\n      uniqueAgents: agents.length,\n      sessionId: generateId('session'),\n      generateSummary,\n      persistState,\n      exportMetrics,\n      metrics,\n    };\n\n    await store.store(`session:${sessionData.sessionId}`, sessionData, {\n      namespace: 'sessions',\n      metadata: { hookType: 'session-end' },\n    });\n\n    // Persist detailed state if requested\n    if (persistState) {\n      const detailedState = {\n        sessionId: sessionData.sessionId,\n        tasks: tasks.slice(0, 100), // Limit to prevent memory issues\n        edits: edits.slice(0, 100),\n        commands: commands.slice(0, 100),\n        agents: agents.slice(0, 50),\n        persistedAt: new Date().toISOString(),\n        fullState: true,\n      };\n\n      await store.store(`session-state:${sessionData.sessionId}`, detailedState, {\n        namespace: 'session-states',\n        metadata: { type: 'full-state', sessionId: sessionData.sessionId },\n      });\n\n      console.log(`  ðŸ’¾ Full session state persisted`);\n    }\n\n    // Export metrics if requested\n    if (exportMetrics && metrics) {\n      await store.store(`session-metrics:${sessionData.sessionId}`, metrics, {\n        namespace: 'session-metrics',\n        metadata: { type: 'performance-metrics', sessionId: sessionData.sessionId },\n      });\n\n      console.log(`  ðŸ“ˆ Session metrics exported`);\n    }\n\n    if (generateSummary) {\n      console.log(`\\nðŸ“Š SESSION SUMMARY:`);\n      console.log(`  ðŸ“‹ Tasks: ${sessionData.totalTasks}`);\n      console.log(`  âœï¸  Edits: ${sessionData.totalEdits}`);\n      console.log(`  ðŸ”§ Commands: ${sessionData.totalCommands}`);\n      console.log(`  ðŸ¤– Agents: ${sessionData.uniqueAgents}`);\n\n      if (metrics) {\n        console.log(`  â±ï¸  Duration: ${metrics.sessionDurationHuman}`);\n        console.log(`  ðŸ“ˆ Success Rate: ${metrics.commandSuccessRate}%`);\n        console.log(`  ðŸƒ Tasks/min: ${metrics.avgTasksPerMinute}`);\n        console.log(`  âœï¸  Edits/min: ${metrics.avgEditsPerMinute}`);\n      }\n    }\n\n    console.log(`  ðŸ’¾ Session saved to .swarm/memory.db`);\n\n    if (memoryStore) {\n      memoryStore.close();\n      memoryStore = null;\n    }\n\n    printSuccess(`Session-end hook completed`);\n  } catch (err) {\n    printError(`Session-end hook failed: ${err.message}`);\n  }\n}\n\nasync function sessionRestoreCommand(subArgs, flags) {\n  const options = flags;\n  const sessionId = options['session-id'] || 'latest';\n\n  console.log(`ðŸ”„ Executing session-restore hook...`);\n  console.log(`ðŸ†” Session: ${sessionId}`);\n\n  try {\n    const store = await getMemoryStore();\n\n    // Find session to restore\n    let sessionData;\n    if (sessionId === 'latest') {\n      const sessions = await store.list({ namespace: 'sessions', limit: 1 });\n      sessionData = sessions[0]?.value;\n    } else {\n      sessionData = await store.retrieve(`session:${sessionId}`, { namespace: 'sessions' });\n    }\n\n    if (sessionData) {\n      console.log(`\\nðŸ“Š RESTORED SESSION:`);\n      console.log(`  ðŸ†” ID: ${sessionData.sessionId || 'unknown'}`);\n      console.log(`  ðŸ“‹ Tasks: ${sessionData.totalTasks || 0}`);\n      console.log(`  âœï¸  Edits: ${sessionData.totalEdits || 0}`);\n      console.log(`  â° Ended: ${sessionData.endedAt || 'unknown'}`);\n\n      // Store restoration event\n      await store.store(\n        `session-restore:${Date.now()}`,\n        {\n          restoredSessionId: sessionData.sessionId || sessionId,\n          restoredAt: new Date().toISOString(),\n        },\n        { namespace: 'session-events' },\n      );\n\n      console.log(`  ðŸ’¾ Session restored from .swarm/memory.db`);\n      printSuccess(`Session restore completed`);\n    } else {\n      printWarning(`No session found with ID: ${sessionId}`);\n    }\n  } catch (err) {\n    printError(`Session restore hook failed: ${err.message}`);\n  }\n}\n\nasync function notifyCommand(subArgs, flags) {\n  const options = flags;\n  const message = options.message || subArgs.slice(1).join(' ');\n  const level = options.level || 'info';\n  const swarmStatus = options['swarm-status'] || 'active';\n\n  console.log(`ðŸ“¢ Executing notify hook...`);\n  console.log(`ðŸ’¬ Message: ${message}`);\n  console.log(`ðŸ“Š Level: ${level}`);\n\n  try {\n    const store = await getMemoryStore();\n    const notificationData = {\n      message,\n      level,\n      swarmStatus,\n      timestamp: new Date().toISOString(),\n      notifyId: generateId('notify'),\n    };\n\n    await store.store(`notification:${notificationData.notifyId}`, notificationData, {\n      namespace: 'hooks:notify',\n      metadata: { hookType: 'notify', level },\n    });\n\n    // Display notification\n    const icon = level === 'error' ? 'âŒ' : level === 'warning' ? 'âš ï¸' : 'âœ…';\n    console.log(`\\n${icon} NOTIFICATION:`);\n    console.log(`  ${message}`);\n    console.log(`  ðŸ Swarm: ${swarmStatus}`);\n\n    console.log(`\\n  ðŸ’¾ Notification saved to .swarm/memory.db`);\n    printSuccess(`Notify hook completed`);\n  } catch (err) {\n    printError(`Notify hook failed: ${err.message}`);\n  }\n}\n\n// ===== PRETOOLUSE MODIFICATION HOOKS (v2.0.10+) =====\n\nasync function modifyBashCommand(subArgs, flags) {\n  // Read JSON from stdin with timeout to detect if data is piped\n  let input = '';\n  let hasInput = false;\n\n  const timeout = setTimeout(() => {\n    if (!hasInput) {\n      console.log('Usage: echo \\'{\"tool_input\":{\"command\":\"your command\"}}\\' | claude-flow hooks modify-bash');\n      console.log('\\nThis hook reads JSON from stdin and outputs modified JSON.');\n      console.log('It is designed for use with Claude Code v2.0.10+ PreToolUse feature.');\n      console.log('\\nExample:');\n      console.log('  echo \\'{\"tool_input\":{\"command\":\"rm test.txt\"}}\\' | claude-flow hooks modify-bash');\n      process.exit(0);\n    }\n  }, 100); // 100ms timeout\n\n  for await (const chunk of process.stdin) {\n    hasInput = true;\n    clearTimeout(timeout);\n    input += chunk;\n  }\n\n  if (!input.trim()) {\n    return; // Silently exit if no input\n  }\n\n  const toolInput = JSON.parse(input);\n  const command = toolInput.tool_input?.command || '';\n\n  if (!command) {\n    console.log(input); // Pass through if no command\n    return;\n  }\n\n  let modifiedCommand = command;\n  const notes = [];\n\n  // 1. Safety: Add -i flag to rm commands\n  if (/^rm\\s/.test(command) && !/-[iI]/.test(command)) {\n    modifiedCommand = command.replace(/^rm /, 'rm -i ');\n    notes.push('[Safety: Added -i flag for interactive confirmation]');\n  }\n\n  // 2. Aliases\n  if (/^ll(\\s|$)/.test(command)) {\n    modifiedCommand = command.replace(/^ll/, 'ls -lah');\n    notes.push('[Alias: ll â†’ ls -lah]');\n  } else if (/^la(\\s|$)/.test(command)) {\n    modifiedCommand = command.replace(/^la/, 'ls -la');\n    notes.push('[Alias: la â†’ ls -la]');\n  }\n\n  // 3. Path correction: Redirect test files to /tmp\n  if (/>\\s*test.*\\.(txt|log|tmp|json|md)/.test(command) && !/\\/tmp\\//.test(command)) {\n    modifiedCommand = command.replace(/>\\s*(test[^/]*\\.(txt|log|tmp|json|md))/, '> /tmp/$1');\n    notes.push('[Path: Redirected test file to /tmp/]');\n  }\n\n  // 4. Secret detection\n  if (/(password|secret|token|api[-_]?key|auth)/i.test(command) && !/#\\s*SECRETS_OK/.test(command)) {\n    notes.push('[Security: Command contains sensitive keywords. Add \"# SECRETS_OK\" to bypass]');\n  }\n\n  // Output modified JSON\n  const output = {\n    ...toolInput,\n    tool_input: {\n      ...toolInput.tool_input,\n      command: modifiedCommand,\n    },\n  };\n\n  if (notes.length > 0) {\n    output.modification_notes = notes.join(' ');\n  }\n\n  console.log(JSON.stringify(output, null, 2));\n}\n\nasync function modifyFileCommand(subArgs, flags) {\n  // Read JSON from stdin with timeout to detect if data is piped\n  let input = '';\n  let hasInput = false;\n\n  const timeout = setTimeout(() => {\n    if (!hasInput) {\n      console.log('Usage: echo \\'{\"tool_input\":{\"file_path\":\"your/file.js\"}}\\' | claude-flow hooks modify-file');\n      console.log('\\nThis hook reads JSON from stdin and outputs modified JSON.');\n      console.log('It is designed for use with Claude Code v2.0.10+ PreToolUse feature.');\n      console.log('\\nExample:');\n      console.log('  echo \\'{\"tool_input\":{\"file_path\":\"test.js\"}}\\' | claude-flow hooks modify-file');\n      process.exit(0);\n    }\n  }, 100); // 100ms timeout\n\n  for await (const chunk of process.stdin) {\n    hasInput = true;\n    clearTimeout(timeout);\n    input += chunk;\n  }\n\n  if (!input.trim()) {\n    return; // Silently exit if no input\n  }\n\n  const toolInput = JSON.parse(input);\n  const filePath = toolInput.tool_input?.file_path || toolInput.tool_input?.path || '';\n\n  if (!filePath) {\n    console.log(input); // Pass through if no file path\n    return;\n  }\n\n  let modifiedPath = filePath;\n  let shouldModify = false;\n  const notes = [];\n\n  // 1. Root folder protection\n  const isRootFile = /^[^/]*\\.(js|ts|jsx|tsx|py|java|go|rs|cpp|c|h)$/.test(filePath) ||\n                     /^test.*\\.(txt|log|tmp|json|md)$/.test(filePath) ||\n                     /^(temp|tmp|working)/.test(filePath);\n\n  if (isRootFile) {\n    if (/test.*\\.(test|spec)\\.|\\.test\\.|\\.spec\\./.test(filePath)) {\n      modifiedPath = `tests/${filePath}`;\n      shouldModify = true;\n      notes.push('[Organization: Moved test file to /tests/]');\n    } else if (/test.*\\.md|temp.*\\.md|working.*\\.md|scratch.*\\.md/.test(filePath)) {\n      modifiedPath = `docs/working/${filePath}`;\n      shouldModify = true;\n      notes.push('[Organization: Moved working document to /docs/working/]');\n    } else if (/\\.(js|ts|jsx|tsx|py)$/.test(filePath)) {\n      modifiedPath = `src/${filePath}`;\n      shouldModify = true;\n      notes.push('[Organization: Moved source file to /src/]');\n    } else if (/^(temp|tmp|scratch)/.test(filePath)) {\n      modifiedPath = `/tmp/${filePath}`;\n      shouldModify = true;\n      notes.push('[Organization: Redirected temporary file to /tmp/]');\n    }\n  }\n\n  // 2. Format hints\n  if (/\\.(ts|tsx|js|jsx)$/.test(modifiedPath)) {\n    notes.push('[Tip: Auto-format with Prettier/ESLint recommended]');\n  } else if (/\\.py$/.test(modifiedPath)) {\n    notes.push('[Tip: Auto-format with Black/autopep8 recommended]');\n  }\n\n  // Output modified JSON\n  const output = {\n    ...toolInput,\n    tool_input: {\n      ...toolInput.tool_input,\n    },\n  };\n\n  if (shouldModify) {\n    if (toolInput.tool_input.file_path) {\n      output.tool_input.file_path = modifiedPath;\n    } else {\n      output.tool_input.path = modifiedPath;\n    }\n  }\n\n  if (notes.length > 0) {\n    output.modification_notes = notes.join(' ');\n  }\n\n  console.log(JSON.stringify(output, null, 2));\n}\n\nasync function modifyGitCommitCommand(subArgs, flags) {\n  // Read JSON from stdin with timeout to detect if data is piped\n  let input = '';\n  let hasInput = false;\n\n  const timeout = setTimeout(() => {\n    if (!hasInput) {\n      console.log('Usage: echo \\'{\"tool_input\":{\"command\":\"git commit -m \\\\\"message\\\\\"\"}}\\'  | claude-flow hooks modify-git-commit');\n      console.log('\\nThis hook reads JSON from stdin and outputs modified JSON.');\n      console.log('It is designed for use with Claude Code v2.0.10+ PreToolUse feature.');\n      console.log('\\nExample:');\n      console.log('  echo \\'{\"tool_input\":{\"command\":\"git commit -m \\\\\"fix bug\\\\\"\"}}\\'  | claude-flow hooks modify-git-commit');\n      process.exit(0);\n    }\n  }, 100); // 100ms timeout\n\n  for await (const chunk of process.stdin) {\n    hasInput = true;\n    clearTimeout(timeout);\n    input += chunk;\n  }\n\n  if (!input.trim()) {\n    return; // Silently exit if no input\n  }\n\n  const toolInput = JSON.parse(input);\n  const command = toolInput.tool_input?.command || '';\n\n  if (!command || !/git commit/.test(command)) {\n    console.log(input); // Pass through if not git commit\n    return;\n  }\n\n  // Extract commit message\n  const msgMatch = command.match(/-m\\s+[\"']([^\"']+)[\"']/) || command.match(/-m\\s+(\\S+)/);\n  const commitMsg = msgMatch ? msgMatch[1] : '';\n\n  if (!commitMsg || /^\\[(feat|fix|docs|style|refactor|test|chore|perf)\\]/.test(commitMsg)) {\n    console.log(input); // Already formatted or no message\n    return;\n  }\n\n  const notes = [];\n\n  // Get current branch\n  let branch = 'main';\n  let ticket = '';\n  try {\n    const { execSync } = await import('child_process');\n    branch = execSync('git rev-parse --abbrev-ref HEAD', { encoding: 'utf8' }).trim();\n\n    // Extract JIRA ticket\n    const ticketMatch = branch.match(/[A-Z]+-[0-9]+/);\n    if (ticketMatch) {\n      ticket = ticketMatch[0];\n    }\n  } catch {\n    // Git not available, continue\n  }\n\n  // Detect conventional commit type\n  let type = 'chore';\n  if (/^(add|implement|create|new)/i.test(commitMsg)) type = 'feat';\n  else if (/^(fix|resolve|patch|correct)/i.test(commitMsg)) type = 'fix';\n  else if (/^(update|modify|change|improve)/i.test(commitMsg)) type = 'refactor';\n  else if (/^(doc|documentation|readme)/i.test(commitMsg)) type = 'docs';\n  else if (/^(test|testing|spec)/i.test(commitMsg)) type = 'test';\n  else if (/^(style|format|lint)/i.test(commitMsg)) type = 'style';\n  else if (/^(perf|optimize|speed)/i.test(commitMsg)) type = 'perf';\n\n  // Format message\n  let formattedMsg = ticket\n    ? `[${type}] ${commitMsg} (${ticket})`\n    : `[${type}] ${commitMsg}`;\n\n  // Add co-author\n  if (!/Co-Authored-By/.test(command)) {\n    formattedMsg += `\\n\\nðŸ¤– Generated with Claude Flow\\nCo-Authored-By: claude-flow <noreply@ruv.io>`;\n  }\n\n  // Replace message in command\n  const modifiedCommand = command.replace(\n    /-m\\s+[\"'][^\"']+[\"']|-m\\s+\\S+/,\n    `-m \"$(cat <<'EOF'\\n${formattedMsg}\\nEOF\\n)\"`\n  );\n\n  notes.push(`[Auto-formatted: ${type} type${ticket ? ` + ${ticket}` : ''}]`);\n\n  // Output modified JSON\n  const output = {\n    ...toolInput,\n    tool_input: {\n      ...toolInput.tool_input,\n      command: modifiedCommand,\n    },\n    modification_notes: notes.join(' '),\n  };\n\n  console.log(JSON.stringify(output, null, 2));\n}\n\nfunction showHooksHelp() {\n  console.log('Claude Flow Hooks (with .swarm/memory.db persistence):\\n');\n\n  console.log('Pre-Operation Hooks:');\n  console.log('  pre-task        Execute before starting a task');\n  console.log('  pre-edit        Validate before file modifications');\n  console.log('                  --auto-assign-agents  Auto-assign agents based on file type');\n  console.log('                  --load-context        Load file context');\n  console.log('  pre-bash        Check command safety (alias: pre-command)');\n  console.log('  pre-command     Same as pre-bash');\n  console.log('                  --validate-safety     Enable safety validation');\n  console.log('                  --prepare-resources   Prepare execution resources');\n\n  console.log('\\nPost-Operation Hooks:');\n  console.log('  post-task       Execute after completing a task');\n  console.log('  post-edit       Auto-format and log edits');\n  console.log('                  --format              Auto-format code');\n  console.log('                  --update-memory       Update agent memory');\n  console.log('                  --train-neural        Train neural patterns');\n  console.log('  post-bash       Log command execution (alias: post-command)');\n  console.log('  post-command    Same as post-bash');\n  console.log('                  --track-metrics       Track performance metrics');\n  console.log('                  --store-results       Store detailed results');\n  console.log('  post-search     Cache search results');\n\n  console.log('\\nMCP Integration Hooks:');\n  console.log('  mcp-initialized    Persist MCP configuration');\n  console.log('  agent-spawned      Update agent roster');\n  console.log('  task-orchestrated  Monitor task progress');\n  console.log('  neural-trained     Save pattern improvements');\n\n  console.log('\\nSession Hooks:');\n  console.log('  session-end        Generate summary and save state');\n  console.log('                     --generate-summary    Generate session summary');\n  console.log('                     --persist-state       Persist session state');\n  console.log('                     --export-metrics      Export performance metrics');\n  console.log('  session-restore    Load previous session state');\n  console.log('  notify             Custom notifications');\n\n  console.log('\\n===== NEW: PreToolUse Modification Hooks (v2.0.10+) =====');\n  console.log('  modify-bash        Modify Bash tool inputs (reads/writes JSON via stdin/stdout)');\n  console.log('                     â€¢ Safety: Adds -i flag to rm commands');\n  console.log('                     â€¢ Aliases: ll â†’ ls -lah, la â†’ ls -la');\n  console.log('                     â€¢ Path correction: Redirects test files to /tmp');\n  console.log('                     â€¢ Secret detection: Warns about sensitive keywords');\n  console.log('');\n  console.log('  modify-file        Modify Write/Edit tool inputs (reads/writes JSON via stdin/stdout)');\n  console.log('                     â€¢ Root folder protection: Moves files to appropriate directories');\n  console.log('                     â€¢ Organization: Tests â†’ /tests/, Sources â†’ /src/, Docs â†’ /docs/');\n  console.log('                     â€¢ Format hints: Suggests Prettier, Black, etc.');\n  console.log('');\n  console.log('  modify-git-commit  Modify git commit messages (reads/writes JSON via stdin/stdout)');\n  console.log('                     â€¢ Conventional commits: Auto-adds [feat], [fix], [docs], etc.');\n  console.log('                     â€¢ Ticket extraction: Extracts JIRA tickets from branch names');\n  console.log('                     â€¢ Co-author: Adds Claude Flow co-author footer');\n\n  console.log('\\nExamples:');\n  console.log('  hooks pre-command --command \"npm test\" --validate-safety true');\n  console.log('  hooks pre-edit --file \"src/app.js\" --auto-assign-agents true');\n  console.log('  hooks post-command --command \"build\" --track-metrics true');\n  console.log('  hooks post-edit --file \"src/app.js\" --format true --train-neural true');\n  console.log('  hooks session-end --generate-summary true --export-metrics true');\n  console.log('  hooks agent-spawned --name \"CodeReviewer\" --type \"reviewer\"');\n  console.log('  hooks notify --message \"Build completed\" --level \"success\"');\n  console.log('');\n  console.log('  # New modification hooks (stdin/stdout JSON):');\n  console.log('  echo \\'{\"tool_input\":{\"command\":\"rm test.txt\"}}\\' | hooks modify-bash');\n  console.log('  echo \\'{\"tool_input\":{\"file_path\":\"test.js\"}}\\' | hooks modify-file');\n  console.log('  echo \\'{\"tool_input\":{\"command\":\"git commit -m \\\\\"fix bug\\\\\"\"}}\\' | hooks modify-git-commit');\n\n  console.log('\\nCompatibility:');\n  console.log('  â€¢ pre-command and pre-bash are aliases');\n  console.log('  â€¢ post-command and post-bash are aliases');\n  console.log('  â€¢ Both --dash-case and camelCase parameters supported');\n  console.log('  â€¢ All parameters from settings.json template supported');\n  console.log('  â€¢ New modification hooks work with Claude Code v2.0.10+ PreToolUse feature');\n}\n\nexport default hooksAction;\n"],"names":["printSuccess","printError","printWarning","execRuvSwarmHook","checkRuvSwarmAvailable","SqliteMemoryStore","InMemoryStore","memoryStore","storeInitFailed","getMemoryStore","initialize","err","isNativeModuleError","message","includes","generateId","prefix","Date","now","Math","random","toString","substr","hooksAction","subArgs","flags","subcommand","options","help","h","showHooksHelp","preTaskCommand","preEditCommand","preBashCommand","postTaskCommand","postEditCommand","postBashCommand","postSearchCommand","mcpInitializedCommand","agentSpawnedCommand","taskOrchestratedCommand","neuralTrainedCommand","sessionEndCommand","sessionRestoreCommand","notifyCommand","modifyBashCommand","modifyFileCommand","modifyGitCommitCommand","description","taskId","agentId","autoSpawnAgents","console","log","store","taskData","status","startedAt","toISOString","namespace","metadata","hookType","timestamp","checkPromise","timeoutPromise","Promise","_","reject","setTimeout","Error","isAvailable","race","hookResult","success","output","close","process","exit","file","operation","autoAssignAgents","loadContext","assignedAgentType","recommendedAgent","path","ext","extname","toLowerCase","agentMapping","type","extension","recommended","contextData","fs","existsSync","stats","statSync","dirname","basename","fileExists","size","modified","mtime","directory","filename","isDirectory","willCreate","error","editData","editId","agentType","ttl","command","slice","join","workingDir","cwd","validateSafety","validate","prepareResources","safetyResult","dangerousCommands","isDangerous","length","some","dangerous","mkdirSync","recursive","bashData","bashId","safety","validationEnabled","resourcesPrepped","toUpperCase","analyzePerformance","retrieve","completedData","completedAt","duration","getTime","metrics","durationHuman","toFixed","memoryKey","format","updateMemory","trainNeural","formatResult","formatters","formatter","attempted","reason","memoryUpdate","editContext","editedAt","formatted","fileSize","neuralTraining","editTime","patterns","fileType","fileName","confidence","enhanced","historyKey","replace","features","exitCode","trackMetrics","storeResults","startTime","commandLength","outputLength","parseInt","complexity","substring","fullOutput","existingMetrics","totalCommands","successRate","avgDuration","lastUpdated","hasMetrics","hasResults","query","resultCount","searchType","searchData","searchId","cachedAt","serverName","server","sessionId","mcpData","initializedAt","agentName","name","swarmId","agentData","spawnedAt","action","strategy","priority","orchestrationData","orchestratedAt","modelName","model","accuracy","trainingData","parseFloat","patternsLearned","trainedAt","generateSummary","persistState","exportMetrics","tasks","list","limit","edits","commands","agents","sessionStart","min","map","t","value","e","c","successfulCommands","filter","commandSuccessRate","sessionDuration","sessionDurationHuman","round","totalTasks","totalEdits","uniqueAgents","avgTasksPerMinute","avgEditsPerMinute","sessionData","endedAt","detailedState","persistedAt","fullState","sessions","restoredSessionId","restoredAt","level","swarmStatus","notificationData","notifyId","icon","input","hasInput","timeout","chunk","stdin","clearTimeout","trim","toolInput","JSON","parse","tool_input","modifiedCommand","notes","test","push","modification_notes","stringify","filePath","file_path","modifiedPath","shouldModify","isRootFile","msgMatch","match","commitMsg","branch","ticket","execSync","encoding","ticketMatch","formattedMsg"],"mappings":"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CZD,QAAQC,GAAG,CAAC;IACZD,QAAQC,GAAG,CAAC;IAEZD,QAAQC,GAAG,CAAC;IACZD,QAAQC,GAAG,CAAC;IACZD,QAAQC,GAAG,CAAC;IACZD,QAAQC,GAAG,CAAC;IACZD,QAAQC,GAAG,CAAC;IAEZD,QAAQC,GAAG,CAAC;IACZD,QAAQC,GAAG,CAAC;IACZD,QAAQC,GAAG,CAAC;IACZD,QAAQC,GAAG,CAAC;IACZD,QAAQC,GAAG,CAAC;IACZD,QAAQC,GAAG,CAAC;IACZD,QAAQC,GAAG,CAAC;IAEZD,QAAQC,GAAG,CAAC;IACZD,QAAQC,GAAG,CAAC;IACZD,QAAQC,GAAG,CAAC;IACZD,QAAQC,GAAG,CAAC;IACZD,QAAQC,GAAG,CAAC;IACZD,QAAQC,GAAG,CAAC;IACZD,QAAQC,GAAG,CAAC;IACZD,QAAQC,GAAG,CAAC;IACZD,QAAQC,GAAG,CAAC;IACZD,QAAQC,GAAG,CAAC;IACZD,QAAQC,GAAG,CAAC;IACZD,QAAQC,GAAG,CAAC;IACZD,QAAQC,GAAG,CAAC;IACZD,QAAQC,GAAG,CAAC;IACZD,QAAQC,GAAG,CAAC;IACZD,QAAQC,GAAG,CAAC;IAEZD,QAAQC,GAAG,CAAC;IACZD,QAAQC,GAAG,CAAC;IACZD,QAAQC,GAAG,CAAC;IACZD,QAAQC,GAAG,CAAC;IACZD,QAAQC,GAAG,CAAC;IACZD,QAAQC,GAAG,CAAC;IACZD,QAAQC,GAAG,CAAC;IACZD,QAAQC,GAAG,CAAC;IACZD,QAAQC,GAAG,CAAC;IACZD,QAAQC,GAAG,CAAC;IACZD,QAAQC,GAAG,CAAC;IACZD,QAAQC,GAAG,CAAC;IACZD,QAAQC,GAAG,CAAC;IAEZD,QAAQC,GAAG,CAAC;IACZD,QAAQC,GAAG,CAAC;IACZD,QAAQC,GAAG,CAAC;IACZD,QAAQC,GAAG,CAAC;IACZD,QAAQC,GAAG,CAAC;IACZD,QAAQC,GAAG,CAAC;AACd;AAEA,eAAe9B,YAAY"}